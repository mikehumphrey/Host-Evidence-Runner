# Investigation Results Directory Structure Guide

**Purpose:** Define how investigation data is organized for multi-server forensic collection  
**Version:** 2.0  
**Date:** December 12, 2025

---

## Quick Reference

```
investigations/
└── InvestigationName_YYYYMMDD/         # Each investigation has its own folder
    ├── INVESTIGATION_METADATA.txt      # Case details and authorization
    ├── INCIDENT_LOG.txt                # Collection timeline and findings
    ├── DEPLOYMENT_TRACKING.txt         # Deployment status (auto-generated)
    ├── HostName_01/                    # Each target host
    │   └── 20251212_143022/            # Each collection attempt (timestamp)
    │       ├── collected_files/        # ← All forensic artifacts here
    │       │   ├── EventLogs/
    │       │   ├── Registry/
    │       │   ├── Prefetch/
    │       │   ├── LNK_Files/
    │       │   ├── ScheduledTasks/
    │       │   ├── Phase2_Advanced_Analysis/
    │       │   ├── SHA256_MANIFEST.txt
    │       │   └── collected_files.zip
    │       └── forensic_collection_HostName_01_20251212_143022.txt
    │
    ├── HostName_02/
    │   ├── 20251212_143500/            # Initial collection
    │   └── 20251212_150000/            # Re-collection
    │
    └── HostName_03/
        └── 20251212_144200/
```

---

## Detailed Structure

### **Level 1: Investigation Folder**

**Path:** `investigations/[InvestigationName_YYYYMMDD]/`

**Purpose:** Container for all results related to one investigation

**Contents:**
- `INVESTIGATION_METADATA.txt` - Case number, scope, authorization, investigators
- `INCIDENT_LOG.txt` - Collection timeline, status updates, findings
- `DEPLOYMENT_TRACKING.txt` - Auto-generated by deploy_multi_server.ps1
- `[HostName]/` - One folder per target system

**Example:**
```
investigations/
├── RansomwareIncident_20251212/
├── APT_Investigation_Q4/
└── Insider_Threat_Review_20251211/
```

---

### **Level 2: Host-Specific Folder**

**Path:** `investigations/[InvestigationName]/[HostName]/`

**Purpose:** Container for all collections from one system

**Naming Convention:**
- Use exact hostname as reported by `$env:COMPUTERNAME`
- Examples:
  - `SERVER01`
  - `DC-MAIN`
  - `WORKSTATION_SMITH_JOHN`
  - Use underscores for spaces; avoid special characters

**Contents:**
- Multiple timestamp folders (one per collection attempt)
- Each timestamp represents a distinct collection run

**Example:**
```
investigations/BreachXYZ/
├── SERVER01/
├── SERVER02/
├── DC_DOMAIN_CONTROLLER/
└── WORKSTATION_USER_ACCOUNTS/
```

---

### **Level 3: Timestamp Folder (Collection Instance)**

**Path:** `investigations/[InvestigationName]/[HostName]/[YYYYMMDD_HHMMSS]/`

**Purpose:** Container for one complete collection from one host at one time

**Naming Convention:**
- Format: `YYYYMMDD_HHMMSS` (24-hour time)
- Auto-generated by collect.ps1
- Allows multiple collections from same host for comparison

**Use Cases:**
```
Initial Collection:        20251212_090000/  (Day 1, morning)
Follow-up Collection:      20251212_150000/  (Day 1, afternoon)
Re-collection with fixes:  20251213_080000/  (Day 2)
Post-remediation check:    20251213_150000/  (Day 2, afternoon)
```

**Contents:**
- `collected_files/` - All forensic artifacts
- `forensic_collection_[HostName]_[Timestamp].txt` - Collection log

---

### **Level 4: Collected Files**

**Path:** `investigations/[InvestigationName]/[HostName]/[Timestamp]/collected_files/`

**Purpose:** All raw forensic artifacts from the target system

**Structure:**

```
collected_files/
├── EventLogs/                           # Phase 1: Windows event logs
│   ├── Application.evtx
│   ├── System.evtx
│   ├── Security.evtx
│   ├── PowerShell_Operational.evtx
│   └── ... (180+ .evtx files)
│
├── Registry/                            # Phase 1: Registry hives
│   ├── C__Windows_System32_config/
│   │   ├── SYSTEM
│   │   ├── SYSTEM.LOG1
│   │   ├── SYSTEM.LOG2
│   │   ├── SOFTWARE
│   │   ├── SAM
│   │   └── SECURITY
│   └── Users/
│       ├── Administrator/
│       │   ├── NTUSER.DAT
│       │   └── NTUSER.DAT.LOG1
│       └── ... (all user profiles)
│
├── Prefetch/                            # Phase 1: Prefetch files
│   ├── EXPLORER.EXE-[hash].pf
│   ├── POWERSHELL.EXE-[hash].pf
│   ├── CMD.EXE-[hash].pf
│   └── ... (500+ .pf files)
│
├── LNK_Files/                           # Phase 1: Shortcuts/jump lists
│   ├── Recent/
│   │   └── ... (user recent items)
│   ├── AutomaticDestinations/
│   │   └── ... (jump list databases)
│   └── CustomDestinations/
│       └── ... (custom shortcuts)
│
├── ScheduledTasks/                      # Phase 1: Scheduled task XML files
│   ├── Microsoft/
│   │   └── Windows/
│   │       ├── PowerShell/
│   │       ├── TaskScheduler/
│   │       └── ... (Windows scheduled tasks)
│   └── ... (all scheduled tasks)
│
├── Phase2_Advanced_Analysis/            # Phase 2: Advanced artifacts
│   ├── Chrome_History_Default.db        # Browser history (SQLite)
│   ├── Chrome_History_Default.txt       # Browser metadata
│   ├── Chrome_History_Profile1.db
│   ├── Firefox_History_*.db
│   ├── Prefetch_Analysis.txt            # Prefetch summary
│   ├── Prefetch_Files/                  # All .pf files (duplicated)
│   │   ├── EXPLORER.EXE-[hash].pf
│   │   └── ... (for external parsers)
│   ├── Suspicious_Scheduled_Tasks.txt   # Threat analysis
│   ├── Amcache.hve                      # Program history
│   ├── SRUM_Database.dat                # Resource usage
│   └── BrowserArtifacts_*/              # Edge/IE cache
│       ├── Edge/
│       │   ├── Bookmarks
│       │   ├── History
│       │   └── Cache/
│       └── InternetExplorer/
│
├── SHA256_MANIFEST.txt                  # ← CRITICAL: Chain of custody
│   └── (SHA256 hashes of all files)
│
├── ExecutableSignatures.txt             # Phase 1: Code signing verification
│   └── (Digital signature report)
│
└── collected_files.zip                  # Compressed archive for transport
```

---

## Data Organization Details

### **EventLogs/ Contents**

Expected files:
```
Application.evtx              # General application events
System.evtx                   # System events (driver load, boot, etc.)
Security.evtx                 # Authentication, privilege use, audit events
Setup.evtx                    # Windows setup and installation
ForwardedEvents.evtx          # Events from remote hosts

PowerShell logs:
  PowerShell_Operational.evtx # Command execution
  PowerShell_Admin.evtx       # Administrative actions

Additional logs:
  TerminalServices-*.evtx     # Remote Desktop connections
  NPS*.evtx                   # Network Policy Server
  WindowsDefender*.evtx       # Antivirus events
  DFS*.evtx                   # File sharing
  ... (180+ total)
```

**Forensic Value:** ⭐⭐⭐⭐⭐ CRITICAL
- Timeline reconstruction
- User authentication and logon
- Privilege escalation attempts
- Network access patterns

---

### **Registry/ Contents**

```
System hives:
  SYSTEM                      # Hardware, boot, network info
  SYSTEM.LOG1, SYSTEM.LOG2    # Transaction logs for consistency
  SOFTWARE                    # Installed software registry
  SOFTWARE.LOG*               # Transaction logs
  SAM                         # User accounts and password hashes
  SECURITY                    # Security policies and event logs
  
User hives:
  Users/Administrator/NTUSER.DAT           # Admin profile
  Users/[Username]/NTUSER.DAT              # User profiles (per user)
  Users/[Username]/AppData/Roaming/Microsoft/Windows/UsrClass.dat
  Users/[Username]/NTUSER.DAT.LOG*
```

**Forensic Value:** ⭐⭐⭐⭐⭐ CRITICAL
- User activity and preferences
- Last logon times
- USB device history
- Network shares connected
- Installed software with versions
- Recently opened files

---

### **Prefetch/ Contents**

```
Example files:
  EXPLORER.EXE-4A2D63F2.pf
  POWERSHELL.EXE-7E8A5C1B.pf
  NOTEPAD.EXE-A1B2C3D4.pf
  MIMIKATZ.EXE-F9E8D7C6.pf    ← Malware example
  ... (typically 500-1000 files)

Filename format:
  [Program].EXE-[8-char-hash].pf
  Where hash is based on program path
```

**Forensic Value:** ⭐⭐⭐⭐
- Program execution timeline
- Last 8 execution times per program
- DLLs loaded by programs
- Persistence mechanism programs
- Attacker tool usage

---

### **LNK_Files/ Contents**

```
Recent items:
  [Username]/AppData/Roaming/Microsoft/Windows/Recent/*.lnk
  
Jump lists (Windows 7+):
  [Username]/AppData/Roaming/Microsoft/Windows/Recent/AutomaticDestinations/
  [Username]/AppData/Roaming/Microsoft/Windows/Recent/CustomDestinations/
  
Start menu shortcuts:
  ProgramData/Microsoft/Windows/Start Menu/
```

**Forensic Value:** ⭐⭐⭐⭐
- Recently accessed files
- User objectives and documents
- USB device access
- Cloud storage access (OneDrive, SharePoint)
- Network share browsing

---

### **ScheduledTasks/ Contents**

```
System scheduled tasks:
  Microsoft/Windows/PowerShell/
  Microsoft/Windows/TaskScheduler/
  Microsoft/Windows/SystemRestore/
  Microsoft/Windows/UpdateOrchestrator/
  ... (hundreds of built-in tasks)
  
Custom scheduled tasks:
  [Custom tasks created by users/admin]
  
Legacy scheduled tasks:
  Windows/Tasks/ (.job files)
```

**Forensic Value:** ⭐⭐⭐⭐
- Persistence mechanisms
- Automated threat activity
- Lateral movement via automation
- Unusual command patterns

---

### **Phase2_Advanced_Analysis/ Contents**

```
Browser Data:
  Chrome_History_Default.db           # SQLite database with history
  Chrome_History_Default.txt          # Metadata
  Chrome_History_Profile1.db          # Additional profiles
  Firefox_History_[profile].db        # Firefox profiles
  BrowserArtifacts_Edge/              # Edge cache and bookmarks
  BrowserArtifacts_InternetExplorer/  # IE cache and history

Prefetch Analysis:
  Prefetch_Analysis.txt               # Human-readable summary
  Prefetch_Files/                     # All .pf files (for external parsing)
    - EXPLORER.EXE-[hash].pf
    - ... (500+ files)

Program Execution:
  Amcache.hve                         # Program history (days/weeks back)
  SRUM_Database.dat                   # System resource usage timeline

Threat Detection:
  Suspicious_Scheduled_Tasks.txt      # Flagged suspicious tasks
```

**Forensic Value:**
- Browser: ⭐⭐⭐⭐⭐ Web activity, user objectives
- Prefetch: ⭐⭐⭐⭐ Program execution timeline
- Amcache: ⭐⭐⭐⭐ Long-term program history
- SRUM: ⭐⭐⭐ Resource usage timeline
- Tasks: ⭐⭐⭐⭐ Persistence indicators

---

## Collection Log File

**Name:** `forensic_collection_[HostName]_[Timestamp].txt`

**Example:** `forensic_collection_SERVER01_20251212_143022.txt`

**Purpose:** Document the collection process, errors, warnings

**Contains:**
- Collection start time
- Computer name and user
- PowerShell version
- Hypervisor detection
- Tool paths and versions
- Each phase's status (Phase 1, Phase 2)
- Hash manifest generation result
- Signature verification result
- String extraction result
- Compression status
- Final success/failure status

**Forensic Value:** ⭐⭐⭐⭐⭐
- Validates collection integrity
- Documents what was/wasn't collected
- Provides timeline of collection process
- Critical for chain of custody

---

## Multi-Host Investigation Example

```
investigations/
└── RansomwareIncident_20251212/
    ├── INVESTIGATION_METADATA.txt
    │   Case #: IR-2025-001234
    │   Scope: Production file servers affected by ransomware
    │   Authorization: Warrant #XYZ
    │   
    ├── INCIDENT_LOG.txt
    │   Collection #1: 2025-12-12 08:00 - FileServer01 (SUCCESS)
    │   Collection #2: 2025-12-12 08:15 - FileServer02 (SUCCESS)
    │   Collection #3: 2025-12-12 08:30 - Workstation01 (PARTIAL)
    │   Initial Finding: Ransomware detected in FileServer01 Event Logs
    │   Re-collection #1: 2025-12-12 14:00 - FileServer01 with tools update
    │   Final Finding: Attacker lateral movement via scheduled tasks
    │   
    ├── DEPLOYMENT_TRACKING.txt  (auto-generated)
    │   Total Targets: 3
    │   Successful: 2
    │   Partial: 1
    │   Failed: 0
    │   
    ├── FileServer01/
    │   ├── 20251212_080000/
    │   │   ├── collected_files/
    │   │   │   ├── EventLogs/           ← Shows ransomware process
    │   │   │   ├── Registry/            ← Shows lateral movement
    │   │   │   ├── Phase2_Advanced_Analysis/
    │   │   │   │   ├── Amcache.hve      ← Shows attacker tools
    │   │   │   │   └── Suspicious_Scheduled_Tasks.txt  ← Persistence
    │   │   │   └── SHA256_MANIFEST.txt  ← Chain of custody
    │   │   └── forensic_collection_FileServer01_20251212_080000.txt
    │   │
    │   └── 20251212_140000/  (re-collection with enhanced tools)
    │       ├── collected_files/
    │       │   ├── Phase2_Advanced_Analysis/
    │       │   │   └── Suspicious_Scheduled_Tasks.txt  ← More details now
    │       │   └── SHA256_MANIFEST.txt
    │       └── forensic_collection_FileServer01_20251212_140000.txt
    │
    ├── FileServer02/
    │   └── 20251212_081500/
    │       ├── collected_files/
    │       └── forensic_collection_FileServer02_20251212_081500.txt
    │
    └── Workstation01/
        └── 20251212_083000/
            ├── collected_files/      (partial due to user interruption)
            └── forensic_collection_Workstation01_20251212_083000.txt
```

---

## Chain of Custody Validation

For each collection, verify:

```powershell
# 1. Check manifest exists
Test-Path "[Investigation]/[Host]/[Timestamp]/collected_files/SHA256_MANIFEST.txt"

# 2. Verify manifests can be compared
Get-FileHash -Path "[Path1]/collected_files/*" -Algorithm SHA256 | 
  Export-Csv "before_analysis.csv"

# 3. Document any post-collection modifications
# (None should occur if following proper procedures)

# 4. Archive complete investigation folder
Compress-Archive -Path investigations/[Investigation]/ -DestinationPath "Archive_[Investigation].zip"
```

---

## Data Movement Workflow

1. **Collection on Target System**
   ```
   Collected data → USB drive or temporary location
   ```

2. **Transfer to Investigation Folder**
   ```
   Copy to: investigations/[InvestigationName]/[HostName]/[Timestamp]/
   ```

3. **Verification**
   ```
   Verify SHA256 manifest
   Verify collection log
   Verify no data loss in transit
   ```

4. **Analysis**
   ```
   Work with data from investigation folder
   Generate reports in same folder
   ```

5. **Archival**
   ```
   Zip entire investigation folder
   Store on archival media
   Verify archive integrity
   ```

---

## Cleanup and Retention

### **Active Investigation**
- Keep all collections
- Keep all timestamps (don't delete old collections)
- Periodically back up investigation folder

### **Closed Investigation**
- Keep latest collection
- Optional: Archive older collections separately
- Document final disposition in INCIDENT_LOG.txt

### **Legal Hold**
- Keep all versions indefinitely
- Document retention on INVESTIGATION_METADATA.txt
- Do NOT delete until explicitly authorized

---

## Troubleshooting Directory Issues

### **Issue: Can't find host data**
**Solution:** Check exact hostname spelling
```powershell
$env:COMPUTERNAME  # Shows the exact hostname used
```

### **Issue: Multiple timestamps from same host**
**Expected:** Each collection gets own timestamp folder
```
Host01/20251212_143000/   ← First collection
Host01/20251212_150000/   ← Second collection (different time)
```

### **Issue: Need to move investigation to different computer**
**Solution:** Copy entire investigation folder to new location
```powershell
Copy-Item investigations/[Investigation]/ -Destination D:\archive\[Investigation] -Recurse
```

---

## Integration with Analysis Tools

### **plaso/log2timeline**
- Reads directly from collected_files/
- Processes EventLogs, Registry, Prefetch
- Generates master timeline CSV

### **WinPrefetchView**
- Reads from Prefetch/ directory
- Exports readable timeline

### **AmcacheParser**
- Reads Amcache.hve directly
- Generates program execution CSV

### **Timeline Analysis**
- Correlate all timestamp sources:
  - Event logs (second precision)
  - Prefetch files (8 executions per program)
  - Browser history (URL visit times)
  - Jump lists (file access times)
  - Amcache (broader time range)

---

## Document Version History

| Version | Date | Changes |
|---------|------|---------|
| 1.0 | 2025-12-12 | Initial structure definition |
| 2.0 | 2025-12-12 | Added Phase 2, investigation examples, workflow |

---

**Approved for investigation use.** Contact forensic team for questions about investigation organization.
